<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>XQuery documentation </title>
    <link rel="stylesheet" type="text/css" href="../../../style.css"></link>
  </head>
  <body>
    <div class="right">
      <img width="104" src="../../../basex.svg"></img>
    </div>
    <h2>Library Module: data/doc/basex.xqm/crypto.xqm</h2>
    <table>
      <tr>
        <td>
          <b>URI:</b>
        </td>
        <td>
          <code>http://expath.org/ns/crypto</code>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>This <a href="http://docs.basex.org/wiki/Module_Library">XQuery Module</a> contains functions to perform cryptographic operations in XQuery. The cryptographic module is based on an early draft of the <a href="http://expath.org/spec/crypto">EXPath Cryptographic Module</a> and provides the following functionality: creation of message authentication codes (HMAC), encryption and decryption, and creation and validation of XML Digital Signatures.</td>
      </tr>
      <tr>
        <td>
          <b>Author:</b>
        </td>
        <td>BaseX Team</td>
      </tr>
      <tr>
        <td>
          <b>See:</b>
        </td>
        <td>http://docs.basex.org/wiki/Module_Library</td>
      </tr>
    </table>
    <h2>Functions</h2>
    <a name="decrypt#4">
      <h3>decrypt($input, $type, $key, $algorithm)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$input</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$type</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$key</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$algorithm</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>Decrypts the encrypted <code>$input</code> .
<p> <code>$type</code> must be <code>symmetric</code>. An option for asymmetric encryption will most likely be added with another version of BaseX. <b>Default is <code>symmetric</code> </b>.
<code>$key</code> is the secret key which is used for both encryption and decryption of input data. Its length is fixed and depends on the chosen algorithm: <code>8 bytes for DES</code>, <code>16 bytes for AES</code>.
<code>$algorithm</code> must either be <code>DES</code> or <code>AES</code>. Other algorithms are not supported so far, but, of course, can be added on demand. <b>Default is <code>DES</code> </b>. </p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0016 padding problems arise.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0017 padding is incorrect.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0018 the encryption type is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0019 the secret key is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0020 the block size is incorrect.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0021 the specified encryption algorithm is not supported.</td>
      </tr>
    </table>
    <a name="encrypt#4">
      <h3>encrypt($input, $encryption, $key, $algorithm)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$input</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$encryption</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$key</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$algorithm</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>Encrypts the given input string.
<p> <code>$encryption</code> must be <code>symmetric</code>, as asymmetric encryption is not supported so far. <b>Default is <code>symmetric</code> </b>.
<code>$key</code> is the secret key which is used for both encryption and decryption of input data. Its length is fixed and depends on the chosen algorithm: <code>8 bytes for DES</code>, <code>16 bytes for AES</code>.
<code>$algorithm</code> must either be <code>DES</code> or <code>AES</code>. Other algorithms are not supported so far, but, of course, can be added on demand. <b>Default is <code>DES</code> </b>. </p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0016 padding problems arise.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0017 padding is incorrect.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0018 the encryption type is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0019 the secret key is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0020 the block size is incorrect.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0021 the specified encryption algorithm is not supported.</td>
      </tr>
    </table>
    <a name="generate-signature#6">
      <h3>generate-signature($input, $canonicalization, $digest, $signature, $prefix, $type)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$input</code>
              </td>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$canonicalization</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$digest</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$signature</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$prefix</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$type</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>
          <code>$canonicalization</code> must either be <code>inclusive-with-comments</code> , <code>inclusive</code> , <code>exclusive-with-comments</code> or <code>exclusive</code> . <b>Default is <code>inclusive-with-comments</code> </b> .
<p> <code>$digest</code> must be one of the following: <code>SHA1</code>, <code>SHA256</code> or <code>SHA512</code>. <b>Default is <code>SHA1</code> </b>.
<code>$signature</code> must either be <code>RSA_SHA1</code> or <code>DSA_SHA1</code>. <b>Default is <code>RSA_SHA1</code> </b>.
<code>$prefix</code> may be empty and prefixes the <code>Signature</code> element accordingly.
<code>$type</code> is the signature type. It must either be <code>enveloped</code> or <code>enveloping</code> (detached signatures are not supported so far). <b>Default is <code>enveloped</code> </b>.
<code>$xpath</code> is an arbitrary XPath expression which specifies a subset of the document that is to be signed.
<code>$certificate</code> is the digitial certificate used to sign the input document.
<code>$ext</code> may either be an <code>$xpath</code> expression or a <code>$certificate</code>.
</p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0001 the canonicalization algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0002 the digest algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0003 the signature algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0004 the <code>$xpath-expression</code> is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0005 the root name of <code>$digital-certificate</code> is not 'digital-certificate.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0007 the key store is null.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0012 the key cannot be found in the specified key store.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0023 the certificate alias is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0024 an invalid algorithm is specified.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0025 an exception occurs while the signing the document.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0026 an exception occurs during key store initialization.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0027 an IO exception occurs.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0028 the signature type is not supported.</td>
      </tr>
    </table>
    <a name="generate-signature#7">
      <h3>generate-signature($input, $canonicalization, $digest, $signature, $prefix, $type, $ext)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$input</code>
              </td>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$canonicalization</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$digest</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$signature</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$prefix</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$type</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$ext</code>
              </td>
              <td>
                <code>item()</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>
          <code>$canonicalization</code> must either be <code>inclusive-with-comments</code> , <code>inclusive</code> , <code>exclusive-with-comments</code> or <code>exclusive</code> . <b>Default is <code>inclusive-with-comments</code> </b> .
<p> <code>$digest</code> must be one of the following: <code>SHA1</code>, <code>SHA256</code> or <code>SHA512</code>. <b>Default is <code>SHA1</code> </b>.
<code>$signature</code> must either be <code>RSA_SHA1</code> or <code>DSA_SHA1</code>. <b>Default is <code>RSA_SHA1</code> </b>.
<code>$prefix</code> may be empty and prefixes the <code>Signature</code> element accordingly.
<code>$type</code> is the signature type. It must either be <code>enveloped</code> or <code>enveloping</code> (detached signatures are not supported so far). <b>Default is <code>enveloped</code> </b>.
<code>$xpath</code> is an arbitrary XPath expression which specifies a subset of the document that is to be signed.
<code>$certificate</code> is the digitial certificate used to sign the input document.
<code>$ext</code> may either be an <code>$xpath</code> expression or a <code>$certificate</code>.
</p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0001 the canonicalization algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0002 the digest algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0003 the signature algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0004 the <code>$xpath-expression</code> is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0005 the root name of <code>$digital-certificate</code> is not 'digital-certificate.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0007 the key store is null.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0012 the key cannot be found in the specified key store.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0023 the certificate alias is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0024 an invalid algorithm is specified.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0025 an exception occurs while the signing the document.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0026 an exception occurs during key store initialization.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0027 an IO exception occurs.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0028 the signature type is not supported.</td>
      </tr>
    </table>
    <a name="generate-signature#8">
      <h3>generate-signature($input, $canonicalization, $digest, $signature, $prefix, $type, $xpath, $certificate)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$input</code>
              </td>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$canonicalization</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$digest</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$signature</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$prefix</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$type</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$xpath</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$certificate</code>
              </td>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>
          <code>$canonicalization</code> must either be <code>inclusive-with-comments</code> , <code>inclusive</code> , <code>exclusive-with-comments</code> or <code>exclusive</code> . <b>Default is <code>inclusive-with-comments</code> </b> .
<p> <code>$digest</code> must be one of the following: <code>SHA1</code>, <code>SHA256</code> or <code>SHA512</code>. <b>Default is <code>SHA1</code> </b>.
<code>$signature</code> must either be <code>RSA_SHA1</code> or <code>DSA_SHA1</code>. <b>Default is <code>RSA_SHA1</code> </b>.
<code>$prefix</code> may be empty and prefixes the <code>Signature</code> element accordingly.
<code>$type</code> is the signature type. It must either be <code>enveloped</code> or <code>enveloping</code> (detached signatures are not supported so far). <b>Default is <code>enveloped</code> </b>.
<code>$xpath</code> is an arbitrary XPath expression which specifies a subset of the document that is to be signed.
<code>$certificate</code> is the digitial certificate used to sign the input document.
<code>$ext</code> may either be an <code>$xpath</code> expression or a <code>$certificate</code>.
</p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0001 the canonicalization algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0002 the digest algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0003 the signature algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0004 the <code>$xpath-expression</code> is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0005 the root name of <code>$digital-certificate</code> is not 'digital-certificate.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0007 the key store is null.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0012 the key cannot be found in the specified key store.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0023 the certificate alias is invalid.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0024 an invalid algorithm is specified.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0025 an exception occurs while the signing the document.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0026 an exception occurs during key store initialization.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0027 an IO exception occurs.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0028 the signature type is not supported.</td>
      </tr>
    </table>
    <a name="hmac#3">
      <h3>hmac($message, $key, $algorithm)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$message</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$key</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$algorithm</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>Creates a message authentication code via a cryptographic hash function and a secret <code>$key</code> .
<p> <code>$encoding</code> must either be <code>hex</code>, <code>base64</code> or the empty string and specifies the encoding of the returned authentication code. <b>Default is <code>base64</code> </b>.
<code>$algorithm</code> describes the hash algorithm which is used for encryption. Currently supported are <code>md5</code>, <code>sha1</code>, <code>sha256</code>, <code>sha384</code>, <code>sha512</code>. <b>Default is <code>md5</code> </b>. </p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0013 the specified hashing algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0014 the specified encoding method is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0019 the specified secret key is invalid.</td>
      </tr>
    </table>
    <a name="hmac#4">
      <h3>hmac($message, $key, $algorithm, $encoding)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$message</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$key</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$algorithm</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$encoding</code>
              </td>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>xs:string</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>Creates a message authentication code via a cryptographic hash function and a secret <code>$key</code> .
<p> <code>$encoding</code> must either be <code>hex</code>, <code>base64</code> or the empty string and specifies the encoding of the returned authentication code. <b>Default is <code>base64</code> </b>.
<code>$algorithm</code> describes the hash algorithm which is used for encryption. Currently supported are <code>md5</code>, <code>sha1</code>, <code>sha256</code>, <code>sha384</code>, <code>sha512</code>. <b>Default is <code>md5</code> </b>. </p>
        </td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0013 the specified hashing algorithm is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0014 the specified encoding method is not supported.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0019 the specified secret key is invalid.</td>
      </tr>
    </table>
    <a name="validate-signature#1">
      <h3>validate-signature($input-doc)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$input-doc</code>
              </td>
              <td>
                <code>node()</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>xs:boolean</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>Checks if the given node contains a <code>Signature</code> element and whether the signature is valid. In this case <code>true</code> is returned. If the signature is invalid the function returns <code>false</code> .</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX0015 the signature element cannot be found.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX9994 an unspecified problem occurs during validation.</td>
      </tr>
      <tr>
        <td>
          <b>Error:</b>
        </td>
        <td>experr:CX9996 an IO exception occurs during validation.</td>
      </tr>
    </table>
  </body>
</html>