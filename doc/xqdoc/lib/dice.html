<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>XQuery documentation </title>
    <link rel="stylesheet" type="text/css" href="../style.css"></link>
  </head>
  <body>
    <div class="right">
      <img width="104" src="../basex.svg"></img>
    </div>
    <h2>Library Module: lib/dice.xqm</h2>
    <table>
      <tr>
        <td>
          <b>URI:</b>
        </td>
        <td>
          <code>quodatum.web.dice/v3</code>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>dice utils - sort, filter, and serialize as json.
can read parameters from request: sort,start,limit.</td>
      </tr>
      <tr>
        <td>
          <b>Author:</b>
        </td>
        <td>andy bunce</td>
      </tr>
      <tr>
        <td>
          <b>Since:</b>
        </td>
        <td>mar 2013</td>
      </tr>
    </table>
    <h2>Variables</h2>
    <h3 name="default">$default</h3>
    <table>
      <tr>
        <td>
          <b>Type:</b>
        </td>
        <td>
          <code>map(*)</code>
        </td>
      </tr>
    </table>
    <h2>Functions</h2>
    <a name="json-flds#2">
      <h3>json-flds($item, $fldmap)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$item</code>
              </td>
              <td>
                <code>item()*</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$fldmap</code>
              </td>
              <td>
                <code>item()*</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>element(_)</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>generate item xml for all fields in map</td>
      </tr>
    </table>
    <a name="json-flds#3">
      <h3>json-flds($item, $fldmap, $keys)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$item</code>
              </td>
              <td>
                <code>element()</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$fldmap</code>
              </td>
              <td>
                <code>map(*)</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$keys</code>
              </td>
              <td>
                <code>xs:string*</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>element(_)</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>generate item xml for some fields in map</td>
      </tr>
    </table>
    <a name="response#2">
      <h3>response($items, $entity)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$items</code>
              </td>
              <td>
                <code>item()*</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$entity</code>
              </td>
              <td>
                <code>map(*)</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>item()*</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>sort, slice, return json</td>
      </tr>
    </table>
    <a name="response#3">
      <h3>response($items, $entity, $opts)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$items</code>
              </td>
              <td>
                <code>item()*</code>
              </td>
              <td>sequence of source items</td>
            </tr>
            <tr>
              <td>
                <code>$entity</code>
              </td>
              <td>
                <code>map(*)</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$opts</code>
              </td>
              <td>
                <code>map(*)</code>
              </td>
              <td>sort and slice values</td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>item()*</code>
              </td>
              <td></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>sort, slice, return json using request parameters</td>
      </tr>
    </table>
    <a name="sort#3">
      <h3>sort($items, $fmap, $sort)</h3>
    </a>
    <table>
      <tr>
        <td>
          <b>Arguments:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>$items</code>
              </td>
              <td>
                <code>item()*</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$fmap</code>
              </td>
              <td>
                <code>map(*)</code>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <code>$sort</code>
              </td>
              <td>
                <code>xs:string?</code>
              </td>
              <td>field name to sort on optional leading +/-</td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Returns:</b>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <code>item()*</code>
              </td>
              <td>sorted items</td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <b>Description:</b>
        </td>
        <td>sort items</td>
      </tr>
    </table>
  </body>
</html>