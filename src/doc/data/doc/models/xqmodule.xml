<entity name="xqmodule" xmlns="https://github.com/Quodatum/app-doc/entity">
	<description>An XQuery source code module</description>
	<namespace prefix="xqdoc" uri="http://www.xqdoc.org/1.0"/>

	<fields>
		<field name="filename" type="xs:string">
			<description>file name</description>
			<xpath>tokenize(base-uri(.),"/")[last()]</xpath>
		</field>
		<field name="href" type="xs:string">
			<description>ui view</description>
			<xpath>("#/data/xqmodule/item?item=" || fn:base-uri(.))</xpath>
		</field>
		<field name="path" type="xs:string">
            <description>path to xdoc in database</description>
            <xpath>db:path(.)</xpath>
        </field>
		<field name="type" type="xs:string">
			<description>"basex", "main" or "library"</description>
			<xpath>(if(starts-with(.,"basex.xqm/"))
			        then "basex" 
			        else xqdoc:module/@type)</xpath>
		</field>
		<field name="description" type="xs:string?">
			<description>source description</description>
			<xpath>xqdoc:module/xqdoc:comment/xqdoc:description</xpath>
		</field>
		<field name="uri" type="xs:string?">
			<description>module namespace</description>
			<xpath>xqdoc:module/xqdoc:uri</xpath>
		</field>
		<field name="name" type="xs:string?">
			<description>module name</description>
			<xpath>xqdoc:module/xqdoc:name</xpath>
		</field>
	</fields>
	<iconclass>fa fa-file-code-o</iconclass>
	<data type="element(xqdoc:xqdoc)">collection("doc-doc")//xqdoc:xqdoc
	</data>
</entity>